<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="./images/favicons.png" crossorigin>
    <title>VietNam Today - B√°o ƒêi·ªán T·ª≠</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes scroll-left {
            0% {
                transform: translateX(100%);
            }

            100% {
                transform: translateX(-100%);
            }
        }

        .animate-scroll {
            display: inline-block;
            padding-left: 100%;
            /* ƒë·ªám ƒë·ªÉ text tr∆∞·ª£t m∆∞·ª£t */
            animation: scroll-left 60s linear infinite;
            white-space: nowrap;
        }

        @font-face {
            font-family: 'SPP';
            src: url('./SPP/SPP-Regular.woff2') format('woff2');
            font-weight: 400;
            font-style: normal;
        }

        @font-face {
            font-family: 'SPP';
            src: url('./SPP/SPP-Medium.woff2') format('woff2');
            font-weight: 500;
            font-style: normal;
        }

        @font-face {
            font-family: 'SPP';
            src: url('./SPP/SPP-SemiBold.woff2') format('woff2');
            font-weight: 600;
            font-style: normal;
        }

        @font-face {
            font-family: 'SPP';
            src: url('./SPP/SPP-Bold.woff2') format('woff2');
            font-weight: 700;
            font-style: normal;
        }

        @import url('https://fonts.googleapis.com/css2?family=Nunito:ital,wght@0,300;0,400;0,500;0,600;0,700;1,400;1,500;1,600&display=swap');

        body {
            font-family: 'SPP', 'Nunito', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        .breaking-news {
            animation: blink 1.5s infinite;
        }

        @keyframes blink {

            0%,
            50% {
                opacity: 1;
            }

            51%,
            100% {
                opacity: 0.7;
            }
        }

        .news-item:hover {
            background-color: #f8f9fa;
            transition: all 0.2s ease;
        }

        .category-tab {
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
        }

        .category-tab:hover,
        .category-tab.active {
            border-bottom-color: #dc2626;
            color: #dc2626;
        }

        .sidebar-widget {
            border-left: 4px solid #dc2626;
        }

        .news-meta {
            font-size: 13px;
            color: #666;
        }

        .main-headline {
            line-height: 1.3;
        }

        .sub-headline {
            line-height: 1.4;
        }
    </style>
</head>

<body class="bg-gray-100">
    <!-- Top Bar -->
    <div class="bg-red-600 text-white py-1">
        <div class="container mx-auto px-4">
            <div class="flex justify-between items-center text-sm">
                <div class="flex items-center space-x-4">
                    <span id="weather">üå°Ô∏è H√† N·ªôi: --¬∞C</span>
                    <span id="date">üìÖ --/--/----</span>
                </div>
                <div class="flex items-center space-x-4">
                    <a href="#" class="hover:underline">English</a>
                    <a href="#" class="hover:underline">RSS</a>
                    <a href="#" class="hover:underline">Li√™n h·ªá</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="bg-white shadow-sm">
        <div class="container mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center">
                    <div class="w-16 h-16 bg-red-600 rounded-lg flex items-center justify-center mr-4">
                        <svg viewBox="0 0 24 24" fill="white" class="w-10 h-10">
                            <path
                                d="M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-1 9H9V9h10v2zm-4 4H9v-2h6v2zm4-8H9V5h10v2z" />
                        </svg>
                    </div>
                    <div>
                        <h1 class="text-3xl font-bold text-red-600">VIETNAM TODAY</h1>
                        <p class="text-sm text-gray-600 uppercase tracking-wide">B√°o ƒëi·ªán t·ª≠ - C·∫≠p nh·∫≠t 24/7</p>
                    </div>
                </div>
                <div class="hidden md:flex items-center space-x-6">
                    <div class="text-right">
                        <p class="text-sm text-gray-600">Hotline:</p>
                        <p class="font-bold text-red-600">+(84)24.6327.1999 | Fax: +(84)24.3771.8838</p>
                    </div>
                    <button class="bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700">
                        ƒêƒÉng k√Ω nh·∫≠n tin
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="bg-gray-800 text-white">
        <div class="container mx-auto px-4">
            <div class="flex items-center justify-between">
                <div class="flex space-x-8">
                    <a href="#" class="category-tab active py-3 px-2 font-medium">TRANG CH·ª¶</a>
                    <a href="#" class="category-tab py-3 px-2 font-medium hover:text-red-400">TH·ªúI S·ª∞</a>
                    <a href="#" class="category-tab py-3 px-2 font-medium hover:text-red-400">C√îNG NGH·ªÜ</a>
                    <a href="#" class="category-tab py-3 px-2 font-medium hover:text-red-400">KINH T·∫æ</a>
                    <a href="#" class="category-tab py-3 px-2 font-medium hover:text-red-400">TH·ªÇ THAO</a>
                    <a href="#" class="category-tab py-3 px-2 font-medium hover:text-red-400">VƒÇN H√ìA</a>
                    <a href="#" class="category-tab py-3 px-2 font-medium hover:text-red-400">GI√ÅO D·ª§C</a>
                </div>
                <div class="flex items-center">
                    <input type="text" placeholder="T√¨m ki·∫øm..." class="px-3 py-1 text-black rounded-l text-sm">
                    <button class="bg-red-600 px-3 py-1 rounded-r hover:bg-red-700">
                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                            <path
                                d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Breaking News -->
    <div class="bg-yellow-400 border-l-4 border-red-600">
        <div class="container mx-auto px-4 py-2">
            <div class="flex items-center">
                <span class="breaking-news bg-red-600 text-white px-3 py-1 rounded font-bold text-sm mr-4">TIN
                    N√ìNG</span>
                <div class="flex-1 overflow-hidden relative">
                    <div id="news-ticker" class="animate-scroll"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-6">
        <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
            <!-- Main Content Area -->
            <div class="lg:col-span-3">
                <!-- Featured News -->
                <section class="bg-white rounded shadow-sm mb-6">
                    <div id="featured-news" class="p-6">
                        <div class="text-center py-8">
                            <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-red-600 mx-auto"></div>
                            <p class="mt-4 text-gray-600">ƒêang t·∫£i tin t·ª©c...</p>
                        </div>
                    </div>
                </section>

                <!-- News Categories -->
                <section id="category-news" class="grid md:grid-cols-2 gap-6 mb-6">
                    <!-- Tech News -->
                    <div class="bg-white rounded shadow-sm">
                        <div class="bg-red-600 text-white px-4 py-2 font-bold">
                            C√îNG NGH·ªÜ
                        </div>
                        <div class="p-4" id="tech-news">
                            <div class="text-center py-4">
                                <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-red-600 mx-auto"></div>
                                <p class="mt-2 text-gray-600">ƒêang t·∫£i...</p>
                            </div>
                        </div>
                    </div>

                    <!-- Economy News -->
                    <div class="bg-white rounded shadow-sm">
                        <div class="bg-green-600 text-white px-4 py-2 font-bold">
                            KINH T·∫æ
                        </div>
                        <div class="p-4" id="business-news">
                            <div class="text-center py-4">
                                <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-green-600 mx-auto">
                                </div>
                                <p class="mt-2 text-gray-600">ƒêang t·∫£i...</p>
                            </div>
                        </div>
                    </div>
                </section>
            </div>

            <!-- Sidebar -->
            <aside class="lg:col-span-1">
                <!-- Most Read -->
                <div class="bg-white rounded shadow-sm mb-6">
                    <div class="bg-blue-600 text-white px-4 py-2 font-bold">
                        TIN ƒê·ªåC NHI·ªÄU
                    </div>
                    <div class="p-4" id="most-read-news">
                        <div class="text-center py-4">
                            <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"></div>
                            <p class="mt-2 text-gray-600">ƒêang t·∫£i...</p>
                        </div>
                    </div>
                </div>

                <!-- Weather Widget -->
                <div class="bg-white rounded shadow-sm mb-6">
                    <div class="bg-cyan-600 text-white px-4 py-2 font-bold flex items-center justify-between">
                        TH·ªúI TI·∫æT
                        <select id="citySelect" class="bg-cyan-700 text-white text-sm rounded px-2 py-1 border-none">
                            <option value="Hanoi">H√† N·ªôi</option>
                            <option value="Ho Chi Minh City">TP.HCM</option>
                            <option value="Da Nang">ƒê√† N·∫µng</option>
                            <option value="Hai Phong">H·∫£i Ph√≤ng</option>
                            <option value="Can Tho">C·∫ßn Th∆°</option>
                        </select>
                    </div>
                    <div class="p-4" id="weatherWidget">
                        <div class="text-center">
                            <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-cyan-600 mx-auto mb-2">
                            </div>
                            <p class="text-gray-600 text-sm">ƒêang t·∫£i th·ªùi ti·∫øt...</p>
                        </div>
                    </div>
                </div>

                <!-- Stock Widget -->
                <div class="bg-white rounded shadow-sm mb-6">
                    <div class="bg-green-600 text-white px-4 py-2 font-bold">
                        CH·ª®NG KHO√ÅN
                    </div>
                    <div class="p-4">
                        <div class="space-y-3">
                            <div class="flex justify-between items-center">
                                <span class="font-medium">VN-Index</span>
                                <div class="text-right">
                                    <div class="font-bold text-green-600">1,252.45</div>
                                    <div class="text-sm text-green-600">+12.34 (+0.99%)</div>
                                </div>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="font-medium">HNX-Index</span>
                                <div class="text-right">
                                    <div class="font-bold text-red-600">234.67</div>
                                    <div class="text-sm text-red-600">-2.15 (-0.91%)</div>
                                </div>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="font-medium">USD/VND</span>
                                <div class="text-right">
                                    <div class="font-bold">24,350</div>
                                    <div class="text-sm text-gray-600">+15 (+0.06%)</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Social Media -->
                <div class="bg-white rounded shadow-sm">
                    <div class="bg-purple-600 text-white px-4 py-2 font-bold">
                        THEO D√ïI CH√öNG T√îI
                    </div>
                    <div class="p-4">
                        <div class="grid grid-cols-2 gap-3">
                            <button
                                class="bg-blue-600 text-white p-3 rounded hover:bg-blue-700 flex items-center justify-center">
                                <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24">
                                    <path
                                        d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z" />
                                </svg>
                                Facebook
                            </button>
                            <button
                                class="bg-red-600 text-white p-3 rounded hover:bg-red-700 flex items-center justify-center">
                                <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24">
                                    <path
                                        d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z" />
                                </svg>
                                YouTube
                            </button>
                        </div>
                        <div class="mt-3 text-center text-sm text-gray-600">
                            <p>üì± T·∫£i ·ª©ng d·ª•ng di ƒë·ªông</p>
                            <div class="flex justify-center space-x-2 mt-2">
                                <button class="bg-black text-white px-3 py-1 rounded text-xs">App Store</button>
                                <button class="bg-green-600 text-white px-3 py-1 rounded text-xs">Google Play</button>
                            </div>
                        </div>
                    </div>
                </div>
            </aside>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-8 mt-8">
        <div class="container mx-auto px-4">
            <div class="grid md:grid-cols-4 gap-6">
                <div>
                    <h3 class="font-bold text-lg mb-4">VietNam Today</h3>
                    <p class="text-gray-400 text-sm mb-4">B√°o ƒëi·ªán t·ª≠ h√†ng ƒë·∫ßu Vi·ªát Nam v·ªÅ c√¥ng ngh·ªá v√† ƒë·ªïi m·ªõi s√°ng
                        t·∫°o.</p>
                    <div class="text-sm text-gray-400">
                        <p>üìß Email: vietnamtoday@vtv.vn</p>
                        <p>üìû Hotline: +(84)24.6327.1999 | Fax: +(84)24.3771.8838 </p>
                        <p>üìç ƒê·ªãa ch·ªâ: 43 Nguyen Chi Thanh Street, Giang Vo, Hanoi, Vietnam</p>
                    </div>
                </div>
                <div>
                    <h4 class="font-bold mb-4">CHUY√äN M·ª§C</h4>
                    <ul class="space-y-2 text-sm text-gray-400">
                        <li><a href="#" class="hover:text-white">Th·ªùi s·ª±</a></li>
                        <li><a href="#" class="hover:text-white">C√¥ng ngh·ªá</a></li>
                        <li><a href="#" class="hover:text-white">Kinh t·∫ø</a></li>
                        <li><a href="#" class="hover:text-white">Th·ªÉ thao</a></li>
                        <li><a href="#" class="hover:text-white">VƒÉn h√≥a</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-bold mb-4">D·ªäCH V·ª§</h4>
                    <ul class="space-y-2 text-sm text-gray-400">
                        <li><a href="#" class="hover:text-white">ƒêƒÉng k√Ω nh·∫≠n tin</a></li>
                        <li><a href="#" class="hover:text-white">·ª®ng d·ª•ng di ƒë·ªông</a></li>
                        <li><a href="#" class="hover:text-white">RSS Feed</a></li>
                        <li><a href="#" class="hover:text-white">Qu·∫£ng c√°o</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-bold mb-4">LI√äN K·∫æT</h4>
                    <ul class="space-y-2 text-sm text-gray-400">
                        <li><a href="#" class="hover:text-white">Ch√≠nh s√°ch b·∫£o m·∫≠t</a></li>
                        <li><a href="#" class="hover:text-white">ƒêi·ªÅu kho·∫£n s·ª≠ d·ª•ng</a></li>
                        <li><a href="#" class="hover:text-white">Li√™n h·ªá</a></li>
                        <li><a href="#" class="hover:text-white">Tuy·ªÉn d·ª•ng</a></li>
                    </ul>
                </div>
            </div>
            <div class="border-t border-gray-700 mt-6 pt-6 text-center text-sm text-gray-400">
                <p>&copy; 2025 VietNam Today. B·∫£n quy·ªÅn thu·ªôc v·ªÅ VietNam Today. C·∫•m sao ch√©p d∆∞·ªõi m·ªçi h√¨nh th·ª©c n·∫øu
                    kh√¥ng c√≥ s·ª± ch·∫•p thu·∫≠n b·∫±ng vƒÉn b·∫£n.</p>
            </div>
        </div>
    </footer>

    <script>
        // API Configuration
        const NEWS_API_KEY = 'pub_be9dfb3f510b4818b806aa8a955ba08b';
        const NEWS_BASE_URL = 'https://newsdata.io/api/1';
        const WEATHER_API_KEY = 'your_openweathermap_api_key'; // Replace with actual API key
        const WEATHER_BASE_URL = 'https://api.open-meteo.com/v1';

        // Format date for display
        function formatDate(dateString) {
            const date = new Date(dateString);
            const now = new Date();
            const diffTime = Math.abs(now - date);
            const diffHours = Math.floor(diffTime / (1000 * 60 * 60));
            const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));

            if (diffHours < 1) return 'V·ª´a xong';
            if (diffHours < 24) return `${diffHours} gi·ªù tr∆∞·ªõc`;
            if (diffDays < 7) return `${diffDays} ng√†y tr∆∞·ªõc`;
            return date.toLocaleDateString('vi-VN');
        }

        // Update current date in top bar
        document.getElementById("date").textContent = "üìÖ " + (function () {
            const now = new Date();
            const days = ["Ch·ªß Nh·∫≠t", "Th·ª© Hai", "Th·ª© Ba", "Th·ª© T∆∞", "Th·ª© NƒÉm", "Th·ª© S√°u", "Th·ª© B·∫£y"];
            const dayName = days[now.getDay()];
            const date = now.getDate().toString().padStart(2, '0');
            const month = (now.getMonth() + 1).toString().padStart(2, '0');
            const year = now.getFullYear();
            return `${dayName}, ${date}/${month}/${year}`;
        })();

        // City coordinates for weather
        const cityCoordinates = {
            'Hanoi': { lat: 21.0285, lon: 105.8542 },
            'Ho Chi Minh City': { lat: 10.8231, lon: 106.6297 },
            'Da Nang': { lat: 16.0544, lon: 108.2022 },
            'Hai Phong': { lat: 20.8449, lon: 106.6881 },
            'Can Tho': { lat: 10.0452, lon: 105.7469 }
        };

        // Category mapping
        const categoryMap = {
            'C√îNG NGH·ªÜ': 'technology',
            'KINH T·∫æ': 'business',
            'TH·ªÇ THAO': 'sports',
            'VƒÇN H√ìA': 'entertainment',
            'TH·ªúI S·ª∞': 'politics',
            'GI√ÅO D·ª§C': 'education'
        };

        const categoryColors = {
            'technology': 'bg-blue-600',
            'business': 'bg-green-600',
            'politics': 'bg-red-600',
            'sports': 'bg-orange-600',
            'entertainment': 'bg-purple-600',
            'education': 'bg-indigo-600',
            'general': 'bg-gray-600'
        };

        const vietnameseCategories = {
            'technology': 'C√¥ng ngh·ªá',
            'business': 'Kinh t·∫ø',
            'politics': 'Th·ªùi s·ª±',
            'sports': 'Th·ªÉ thao',
            'entertainment': 'VƒÉn h√≥a',
            'education': 'Gi√°o d·ª•c',
            'general': 'T·ªïng h·ª£p'
        };

        // Fetch news from Newsdata.io
        async function fetchNews(category = '', query = '') {
            try {
                let url = `${NEWS_BASE_URL}/news?apikey=${NEWS_API_KEY}&country=vi&language=vi`;
                if (category) url += `&category=${category}`;
                if (query) url += `&q=${encodeURIComponent(query)}`;

                const response = await fetch(url);
                const data = await response.json();

                if (data.status === 'success') {
                    return data.results || [];
                }
                console.error('API Error:', data.message);
                return [];
            } catch (error) {
                console.error('Fetch Error:', error);
                return [];
            }
        }

        // Fetch weather from Open-Meteo
        async function fetchWeather(city = 'Hanoi') {
            try {
                const coords = cityCoordinates[city];
                if (!coords) {
                    console.error('City coordinates not found:', city);
                    return null;
                }

                const response = await fetch(`${WEATHER_BASE_URL}/forecast?latitude=${coords.lat}&longitude=${coords.lon}&current_weather=true&hourly=temperature_2m&timezone=auto`);
                const data = await response.json();

                if (data.current_weather) {
                    return {
                        main: {
                            temp: data.current_weather.temperature,
                            feels_like: data.current_weather.temperature,
                            temp_min: Math.min(...data.hourly.temperature_2m.slice(0, 24)),
                            temp_max: Math.max(...data.hourly.temperature_2m.slice(0, 24)),
                            humidity: data.hourly.relativehumidity_2m ? data.hourly.relativehumidity_2m[0] : 0,
                            pressure: data.hourly.pressure_msl ? data.hourly.pressure_msl[0] : 0
                        },
                        wind: { speed: data.current_weather.windspeed / 3.6 },
                        visibility: 10000,
                        weather: [{ description: data.current_weather.weathercode.toString() }]
                    };
                }
                console.error('Weather API Error:', data);
                return null;
            } catch (error) {
                console.error('Weather Fetch Error:', error);
                return null;
            }
        }

        // Get weather icon based on WMO weather code
        function getWeatherIcon(weatherCode) {
            const codeMap = {
                '0': '‚òÄÔ∏è', '1': '‚õÖ', '2': '‚õÖ', '3': '‚òÅÔ∏è', '45': 'üå´Ô∏è', '48': 'üå´Ô∏è',
                '51': 'üå¶Ô∏è', '53': 'üå¶Ô∏è', '55': 'üå¶Ô∏è', '61': 'üåßÔ∏è', '63': 'üåßÔ∏è', '65': 'üåßÔ∏è',
                '71': '‚ùÑÔ∏è', '73': '‚ùÑÔ∏è', '75': '‚ùÑÔ∏è', '80': 'üåßÔ∏è', '81': 'üåßÔ∏è', '82': 'üåßÔ∏è',
                '95': '‚õàÔ∏è', '96': '‚õàÔ∏è', '99': '‚õàÔ∏è'
            };
            return codeMap[weatherCode] || 'üå§Ô∏è';
        }

        // Get Vietnamese weather description
        function getVietnameseWeatherDesc(weatherCode) {
            const descMap = {
                '0': 'Tr·ªùi quang', '1': '√çt m√¢y', '2': 'M√¢y r·∫£i r√°c', '3': 'Nhi·ªÅu m√¢y',
                '45': 'S∆∞∆°ng m√π', '48': 'S∆∞∆°ng m√π d√†y ƒë·∫∑c', '51': 'M∆∞a ph√πn nh·∫π',
                '53': 'M∆∞a ph√πn v·ª´a', '55': 'M∆∞a ph√πn d√†y', '61': 'M∆∞a nh·∫π',
                '63': 'M∆∞a v·ª´a', '65': 'M∆∞a to', '71': 'Tuy·∫øt nh·∫π', '73': 'Tuy·∫øt v·ª´a',
                '75': 'Tuy·∫øt n·∫∑ng', '80': 'M∆∞a r√†o nh·∫π', '81': 'M∆∞a r√†o v·ª´a',
                '82': 'M∆∞a r√†o to', '95': 'D√¥ng b√£o', '96': 'D√¥ng b√£o k√®m m∆∞a ƒë√°',
                '99': 'D√¥ng b√£o k√®m m∆∞a ƒë√° l·ªõn'
            };
            return descMap[weatherCode] || 'Th·ªùi ti·∫øt kh√¥ng x√°c ƒë·ªãnh';
        }

        // Create news card HTML
        function createNewsCard(article, isMain = false) {
            const category = vietnameseCategories[article.category?.[0] || 'general'] || 'T·ªïng h·ª£p';
            const categoryColor = categoryColors[article.category?.[0] || 'general'] || 'bg-gray-600';
            const timeAgo = formatDate(article.pubDate);
            const imageUrl = article.image_url || '';

            if (isMain) {
                return `
                <div class="grid md:grid-cols-2 gap-6">
                    <div>
                        <div class="relative mb-4">
                            ${imageUrl ?
                        `<img src="${imageUrl}" alt="${article.title}" class="w-full h-64 object-cover rounded" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">` :
                        ''
                    }
                            <div class="h-64 ${categoryColor} rounded flex items-center justify-center ${imageUrl ? 'hidden' : ''}">
                                <div class="text-center text-white">
                                    <div class="w-16 h-16 mx-auto mb-3">
                                        <svg viewBox="0 0 24 24" fill="currentColor" class="w-full h-full">
                                            <path d="M12 2l3.09 6.26L22 9l-5.91.74L12 16l-4.09-6.26L2 9l6.91-.74L12 2z"/>
                                        </svg>
                                    </div>
                                    <p class="text-lg font-semibold">${category}</p>
                                </div>
                            </div>
                            <span class="absolute top-3 left-3 bg-red-600 text-white px-2 py-1 rounded text-xs font-bold">HOT</span>
                        </div>
                        <div class="mb-2">
                            <span class="text-red-600 font-semibold text-sm uppercase">${category}</span>
                            <span class="text-gray-500 text-sm ml-2">‚Ä¢ ${timeAgo}</span>
                        </div>
                        <h2 class="main-headline text-xl font-bold text-gray-900 mb-3 hover:text-red-600 cursor-pointer">
                            ${article.title}
                        </h2>
                        <p class="text-gray-600 text-sm leading-relaxed">
                            ${article.description || article.content?.substring(0, 200) + '...' || 'N·ªôi dung ƒëang ƒë∆∞·ª£c c·∫≠p nh·∫≠t...'}
                        </p>
                        ${article.link ? `<a href="${article.link}" target="_blank" class="inline-block mt-3 bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 text-sm">ƒê·ªçc ti·∫øp ‚Üí</a>` : ''}
                    </div>
                    <div id="secondary-news" class="space-y-4">
                        <!-- Secondary news will be loaded here -->
                    </div>
                </div>
            `;
            } else {
                return `
                <article class="news-item p-3 rounded cursor-pointer" onclick="window.open('${article.link}', '_blank')">
                    <div class="flex space-x-3">
                        <div class="w-20 h-16 ${categoryColor} rounded flex-shrink-0 flex items-center justify-center">
                            <svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 2l3.09 6.26L22 9l-5.91.74L12 16l-4.09-6.26L2 9l6.91-.74L12 2z"/>
                            </svg>
                        </div>
                        <div class="flex-1">
                            <div class="news-meta mb-1">
                                <span class="text-red-600 font-medium">${category}</span> ‚Ä¢ ${timeAgo}
                            </div>
                            <h3 class="sub-headline font-semibold text-gray-900 hover:text-red-600">
                                ${article.title}
                            </h3>
                        </div>
                    </div>
                </article>
            `;
            }
        }

        // Create category news section
        function createCategorySection(articles, categoryName, categoryColor) {
            if (!articles || articles.length === 0) return '';

            return `
            <div class="bg-white rounded shadow-sm">
                <div class="${categoryColor} text-white px-4 py-2 font-bold">
                    ${categoryName.toUpperCase()}
                </div>
                <div class="p-4">
                    ${articles.slice(0, 3).map(article => `
                        <article class="mb-4 pb-4 border-b border-gray-200 last:border-b-0 last:mb-0 last:pb-0 cursor-pointer" onclick="window.open('${article.link}', '_blank')">
                            <div class="news-meta mb-2">${formatDate(article.pubDate)}</div>
                            <h3 class="font-semibold text-gray-900 hover:text-red-600 cursor-pointer mb-2">
                                ${article.title}
                            </h3>
                            ${article.description ? `<p class="text-sm text-gray-600">${article.description.substring(0, 100)}...</p>` : ''}
                        </article>
                    `).join('')}
                </div>
            </div>
        `;
        }

        // Load weather
        async function loadWeather(city = 'Hanoi') {
            const weatherWidget = document.getElementById('weatherWidget');
            try {
                weatherWidget.innerHTML = `
                <div class="text-center">
                    <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-cyan-600 mx-auto mb-2"></div>
                    <p class="text-gray-600 text-sm">ƒêang t·∫£i th·ªùi ti·∫øt...</p>
                </div>
            `;

                const weatherData = await fetchWeather(city);
                if (!weatherData) {
                    weatherWidget.innerHTML = `
                    <div class="text-center py-4">
                        <p class="text-red-600 text-sm">Kh√¥ng th·ªÉ t·∫£i th·ªùi ti·∫øt</p>
                        <button onclick="loadWeather('${city}')" class="mt-2 text-cyan-600 text-sm hover:underline">Th·ª≠ l·∫°i</button>
                    </div>
                `;
                    return;
                }

                const temp = Math.round(weatherData.main.temp);
                const feelsLike = Math.round(weatherData.main.feels_like);
                const humidity = weatherData.main.humidity;
                const windSpeed = Math.round(weatherData.wind.speed * 3.6);
                const pressure = Math.round(weatherData.main.pressure);
                const visibility = Math.round(weatherData.visibility / 1000);
                const weatherIcon = getWeatherIcon(weatherData.weather[0].description);
                const weatherDesc = getVietnameseWeatherDesc(weatherData.weather[0].description);
                const cityName = city === 'Ho Chi Minh City' ? 'TP.HCM' : city;
                const minTemp = Math.round(weatherData.main.temp_min);
                const maxTemp = Math.round(weatherData.main.temp_max);

                weatherWidget.innerHTML = `
                <div class="text-center">
                    <div class="text-4xl mb-3">${weatherIcon}</div>
                    <div class="text-3xl font-bold text-gray-900 mb-1">${temp}¬∞C</div>
                    <div class="text-sm text-gray-600 mb-1">C·∫£m gi√°c nh∆∞ ${feelsLike}¬∞C</div>
                    <div class="text-sm text-gray-600 mb-4 capitalize">${cityName} - ${weatherDesc}</div>
                    <div class="flex justify-center space-x-4 text-xs text-gray-500 mb-4">
                        <span>‚Üë${maxTemp}¬∞</span>
                        <span>‚Üì${minTemp}¬∞</span>
                    </div>
                    <div class="grid grid-cols-2 gap-2 text-sm">
                        <div class="bg-gray-50 p-2 rounded">
                            <div class="font-medium text-gray-700">üíß ƒê·ªô ·∫©m</div>
                            <div class="text-blue-600 font-semibold">${humidity}%</div>
                        </div>
                        <div class="bg-gray-50 p-2 rounded">
                            <div class="font-medium text-gray-700">üí® Gi√≥</div>
                            <div class="text-blue-600 font-semibold">${windSpeed} km/h</div>
                        </div>
                        <div class="bg-gray-50 p-2 rounded">
                            <div class="font-medium text-gray-700">üå°Ô∏è √Åp su·∫•t</div>
                            <div class="text-blue-600 font-semibold">${pressure} mb</div>
                        </div>
                        <div class="bg-gray-50 p-2 rounded">
                            <div class="font-medium text-gray-700">üëÅÔ∏è T·∫ßm nh√¨n</div>
                            <div class="text-blue-600 font-semibold">${visibility} km</div>
                        </div>
                    </div>
                    <div class="mt-3 text-xs text-gray-500">
                        C·∫≠p nh·∫≠t: ${new Date().toLocaleTimeString('vi-VN', { hour: '2-digit', minute: '2-digit' })}
                    </div>
                </div>
            `;

                document.getElementById('weather').textContent = `üå°Ô∏è ${cityName}: ${temp}¬∞C`;
            } catch (error) {
                console.error('Error loading weather:', error);
                weatherWidget.innerHTML = `
                <div class="text-center py-4">
                    <p class="text-red-600 text-sm">L·ªói khi t·∫£i th·ªùi ti·∫øt</p>
                    <button onclick="loadWeather('${city}')" class="mt-2 text-cyan-600 text-sm hover:underline">Th·ª≠ l·∫°i</button>
                </div>
            `;
            }
        }

        // Load breaking news ticker
        async function loadBreakingNews() {
            const breakingNewsTicker = document.getElementById('news-ticker');
            try {
                breakingNewsTicker.innerHTML = `<span class="text-gray-600">ƒêang t·∫£i tin n√≥ng...</span>`;
                const allNews = await fetchNews(); // Fetch latest news
                if (allNews.length > 0) {
                    breakingNewsTicker.innerHTML = allNews.slice(0, 5).map(article => `
                    <span class="whitespace-nowrap mr-8">
                        üî• <a href="${article.link}" target="_blank" class="hover:underline">
                            ${article.title}
                        </a>
                    </span>
                `).join('');
                } else {
                    breakingNewsTicker.innerHTML = `<span class="text-gray-600">Kh√¥ng c√≥ tin n√≥ng m·ªõi.</span>`;
                }
            } catch (error) {
                console.error('Error loading breaking news:', error);
                breakingNewsTicker.innerHTML = `<span class="text-red-600">L·ªói khi t·∫£i tin n√≥ng.</span>`;
            }
        }

        // Load all news content
        async function loadNews() {
            try {
                const featuredSection = document.getElementById('featured-news');
                const techNewsSection = document.getElementById('tech-news');
                const businessNewsSection = document.getElementById('business-news');
                const mostReadSection = document.getElementById('most-read-news');
                const breakingNewsTicker = document.getElementById('news-ticker');

                // Show loading states
                featuredSection.innerHTML = `
                <div class="text-center py-8">
                    <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-red-600 mx-auto"></div>
                    <p class="mt-4 text-gray-600">ƒêang t·∫£i tin t·ª©c...</p>
                </div>`;
                techNewsSection.innerHTML = businessNewsSection.innerHTML = `
                <div class="text-center py-4">
                    <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-red-600 mx-auto"></div>
                    <p class="mt-2 text-gray-600">ƒêang t·∫£i...</p>
                </div>`;
                mostReadSection.innerHTML = `
                <div class="text-center py-4">
                    <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"></div>
                    <p class="mt-2 text-gray-600">ƒêang t·∫£i...</p>
                </div>`;
                breakingNewsTicker.innerHTML = `
                <span class="text-gray-600">ƒêang t·∫£i tin n√≥ng...</span>`;

                // Fetch all news
                const allNews = await fetchNews();
                if (allNews.length === 0) {
                    featuredSection.innerHTML = `
                    <div class="text-center py-8">
                        <p class="text-red-600">Kh√¥ng th·ªÉ t·∫£i tin t·ª©c. Vui l√≤ng th·ª≠ l·∫°i sau.</p>
                    </div>`;
                    return;
                }

                // Featured news
                if (allNews.length > 0) {
                    featuredSection.innerHTML = createNewsCard(allNews[0], true);
                    const secondaryContainer = document.getElementById('secondary-news');
                    if (secondaryContainer && allNews.length > 1) {
                        secondaryContainer.innerHTML = allNews.slice(1, 4).map(article => createNewsCard(article)).join('');
                    }
                }

                // Technology and Business news
                const techNews = allNews.filter(article => article.category?.includes('technology'));
                const businessNews = allNews.filter(article => article.category?.includes('business'));

                techNewsSection.innerHTML = techNews.length > 0 ? techNews.slice(0, 3).map(article => `
                <article class="mb-4 pb-4 border-b border-gray-200 last:border-b-0 last:mb-0 last:pb-0 cursor-pointer" onclick="window.open('${article.link}', '_blank')">
                    <div class="news-meta mb-2">${formatDate(article.pubDate)}</div>
                    <h3 class="font-semibold text-gray-900 hover:text-red-600 cursor-pointer mb-2">
                        ${article.title}
                    </h3>
                    ${article.description ? `<p class="text-sm text-gray-600">${article.description.substring(0, 100)}...</p>` : ''}
                </article>
            `).join('') : '<p class="text-gray-600">Kh√¥ng c√≥ tin t·ª©c c√¥ng ngh·ªá.</p>';

                businessNewsSection.innerHTML = businessNews.length > 0 ? businessNews.slice(0, 3).map(article => `
                <article class="mb-4 pb-4 border-b border-gray-200 last:border-b-0 last:mb-0 last:pb-0 cursor-pointer" onclick="window.open('${article.link}', '_blank')">
                    <div class="news-meta mb-2">${formatDate(article.pubDate)}</div>
                    <h3 class="font-semibold text-gray-900 hover:text-red-600 cursor-pointer mb-2">
                        ${article.title}
                    </h3>
                    ${article.description ? `<p class="text-sm text-gray-600">${article.description.substring(0, 100)}...</p>` : ''}
                </article>
            `).join('') : '<p class="text-gray-600">Kh√¥ng c√≥ tin t·ª©c kinh t·∫ø.</p>';

                // Most read news
                if (mostReadSection && allNews.length > 4) {
                    const randomArticles = allNews.slice(4, 8);
                    mostReadSection.innerHTML = randomArticles.map((article, index) => `
                    <article class="flex items-start space-x-3 cursor-pointer hover:bg-gray-50 p-2 rounded" onclick="window.open('${article.link}', '_blank')">
                        <span class="bg-red-600 text-white w-6 h-6 rounded-full flex items-center justify-center text-sm font-bold flex-shrink-0">${index + 1}</span>
                        <div>
                            <h4 class="font-semibold text-sm text-gray-900 hover:text-red-600">${article.title}</h4>
                            <div class="news-meta mt-1">${formatDate(article.pubDate)} ‚Ä¢ ${Math.floor(Math.random() * 20) + 5}k l∆∞·ª£t ƒë·ªçc</div>
                        </div>
                    </article>
                `).join('');
                }

                // Breaking news ticker
                breakingNewsTicker.innerHTML = allNews.length > 0 ? allNews.slice(0, 5).map(article => `
                <span class="whitespace-nowrap mr-8">
                    üî• <a href="${article.link}" target="_blank" class="hover:underline">
                        ${article.title}
                    </a>
                </span>
            `).join('') : `<span class="text-gray-600">Kh√¥ng c√≥ tin n√≥ng m·ªõi.</span>`;
            } catch (error) {
                console.error('Error loading news:', error);
                document.getElementById('featured-news').innerHTML = `
                <div class="text-center py-8">
                    <p class="text-red-600">L·ªói khi t·∫£i tin t·ª©c. Vui l√≤ng th·ª≠ l·∫°i sau.</p>
                </div>`;
            }
        }

        // Search news
        async function searchNews(query) {
            if (!query.trim()) {
                alert('Vui l√≤ng nh·∫≠p t·ª´ kh√≥a t√¨m ki·∫øm');
                return;
            }

            try {
                const searchResults = await fetchNews('', query);
                const featuredSection = document.getElementById('featured-news');

                if (searchResults.length === 0) {
                    featuredSection.innerHTML = `
                    <div class="text-center py-8">
                        <p class="text-gray-600">Kh√¥ng t√¨m th·∫•y k·∫øt qu·∫£ cho "${query}"</p>
                        <button onclick="loadNews()" class="mt-4 bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700">‚Üê Quay l·∫°i trang ch·ªß</button>
                    </div>`;
                    return;
                }

                featuredSection.innerHTML = `
                <div class="mb-4">
                    <h2 class="text-xl font-bold text-gray-900">K·∫øt qu·∫£ t√¨m ki·∫øm cho: "${query}"</h2>
                    <p class="text-gray-600">T√¨m th·∫•y ${searchResults.length} k·∫øt qu·∫£</p>
                </div>
                <div class="space-y-4">
                    ${searchResults.slice(0, 5).map(article => `
                        <article class="border-b border-gray-200 pb-4 cursor-pointer" onclick="window.open('${article.link}', '_blank')">
                            <div class="news-meta mb-2">
                                <span class="text-red-600 font-medium">${vietnameseCategories[article.category?.[0] || 'general'] || 'T·ªïng h·ª£p'}</span> ‚Ä¢ ${formatDate(article.pubDate)}
                            </div>
                            <h3 class="font-semibold text-gray-900 hover:text-red-600 mb-2">${article.title}</h3>
                            ${article.description ? `<p class="text-sm text-gray-600">${article.description.substring(0, 200)}...</p>` : ''}
                        </article>
                    `).join('')}
                </div>
                <button onclick="loadNews()" class="mt-4 bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700">
                    ‚Üê Quay l·∫°i trang ch·ªß
                </button>
            `;
            } catch (error) {
                console.error('Search error:', error);
                alert('L·ªói khi t√¨m ki·∫øm. Vui l√≤ng th·ª≠ l·∫°i sau.');
            }
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function () {
            loadNews();
            loadWeather();

            // News item hover effects
            document.addEventListener('click', function (e) {
                if (e.target.closest('.news-item')) {
                    const item = e.target.closest('.news-item');
                    item.style.backgroundColor = '#fee2e2';
                    setTimeout(() => {
                        item.style.backgroundColor = '';
                    }, 300);
                }
            });

            // Category tab switching
            const categoryTabs = document.querySelectorAll('.category-tab');
            categoryTabs.forEach(tab => {
                tab.addEventListener('click', async function (e) {
                    e.preventDefault();
                    categoryTabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');

                    const category = categoryMap[this.textContent.trim()];
                    if (category) {
                        const categoryNews = await fetchNews(category);
                        const featuredSection = document.getElementById('featured-news');
                        if (featuredSection && categoryNews.length > 0) {
                            featuredSection.innerHTML = `
                            <div class="mb-4">
                                <h2 class="text-xl font-bold text-gray-900">${vietnameseCategories[category]}</h2>
                            </div>
                            <div class="space-y-4">
                                ${categoryNews.slice(0, 6).map(article => createNewsCard(article)).join('')}
                            </div>
                            <button onclick="loadNews()" class="mt-4 bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700">
                                ‚Üê Quay l·∫°i trang ch·ªß
                            </button>
                        `;
                        }
                    } else if (this.textContent.trim() === 'TRANG CH·ª¶') {
                        loadNews();
                    }
                });
            });

            // Search functionality
            const searchButton = document.querySelector('nav button');
            const searchInput = document.querySelector('nav input[type="text"]');
            if (searchButton && searchInput) {
                searchButton.addEventListener('click', function () {
                    searchNews(searchInput.value);
                });
                searchInput.addEventListener('keypress', function (e) {
                    if (e.key === 'Enter') {
                        searchNews(this.value);
                    }
                });
            }

            // Newsletter subscription
            const subscribeButton = document.querySelector('button:contains("ƒêƒÉng k√Ω nh·∫≠n tin")');
            if (subscribeButton) {
                subscribeButton.addEventListener('click', function () {
                    alert('C·∫£m ∆°n b·∫°n ƒë√£ ƒëƒÉng k√Ω nh·∫≠n tin t·ª´ B√°o ƒêi·ªán T·ª≠!');
                });
            }

            // City selection for weather
            const citySelect = document.getElementById('citySelect');
            if (citySelect) {
                citySelect.addEventListener('change', function () {
                    loadWeather(this.value);
                });
            }

            // Auto-refresh content
            setInterval(loadNews, 5 * 60 * 1000); // Refresh all news every 5 minutes
            setInterval(loadBreakingNews, 60 * 1000); // Refresh breaking news every 60 seconds
            setInterval(() => {
                const selectedCity = document.getElementById('citySelect')?.value || 'Hanoi';
                loadWeather(selectedCity);
            }, 10 * 60 * 1000); // Refresh weather every 10 minutes
        });

        // Make functions globally available
        window.loadNews = loadNews;
        window.searchNews = searchNews;
        window.loadWeather = loadWeather;
        window.loadBreakingNews = loadBreakingNews;
    </script>
</body>

</html>
